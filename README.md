# 文件上传对比分析工具

这是一个用于对比分析文件上传计划和实际上传情况的工具，支持桌面版和Web版两种使用方式。

## 功能特点

### 桌面版功能
1. 支持多种操作模式：
   - 命令行模式：直接运行脚本进行分析
   - GUI模式：图形界面操作，更直观易用
   - 文件着色模式：对文件2进行直接着色标记

2. 自动对比分析：
   - 读取文件1（上传计划）中的计划上传文件
   - 读取文件2（实际上传情况）中的已上传文件
   - 对比两者的路径信息，标记匹配状态

3. 结果可视化：
   - 生成Excel报告，包含所有对比结果
   - 已匹配的记录用黄色标记
   - 未匹配的记录用橙色标记（原红色已改为橙色）

### Web版功能
1. 基于Web的用户界面，可通过浏览器访问
2. 实时进度显示和状态更新
3. 统计信息展示（标黄条目、标橙条目、待上传条目）
4. 结果文件在线下载

## 使用方法

### 桌面版使用方法

#### 方法1：文件2着色分析（直接标记原文件）
```bash
python color_file2_complete.py 文件1.xls 文件2.xls 输出着色文件.xlsx
```

#### 方法2：GUI模式
```bash
python file_coloring_gui_enhanced.py
```
然后在图形界面中选择文件并点击"开始分析"按钮，程序会自动提示选择输出文件保存位置，并在结果中增加数据来源列。

### Web版使用方法

#### 启动Web应用
```bash
# Linux/macOS
./start_web_app.sh

# Windows
start_web_app.bat

# 或者直接运行
python web_app.py
```

#### 访问Web应用
启动后，打开浏览器访问以下地址之一：
- 本地访问: http://127.0.0.1:9080
- 网络访问: http://你的IP地址:9080

#### Web应用操作步骤
1. 上传"上传分析依据文件"（文件1）
2. 上传"需要分析的文件"（文件2）
3. 点击"开始分析"按钮
4. 等待分析完成，查看统计结果
5. 点击"下载分析结果"按钮获取着色后的Excel文件

#### 日志记录
Web应用会自动记录运行日志到 `web_app.log` 文件中，包含：
- 应用启动和停止信息
- 用户请求和响应
- 错误和异常信息
- 文件处理和下载记录

## 文件说明

- `color_file2_complete.py`：文件着色脚本（完整版，处理所有行，根据文件编号是否为空区分颜色）
- `file_coloring_gui_enhanced.py`：带图形界面的分析工具（增强版，推荐使用）
- `web_app.py`：Web版应用主程序
- `start_web_app.sh`：Linux/macOS启动脚本
- `start_web_app.bat`：Windows启动脚本
- `templates/`：Web应用模板文件目录
- `文件1.xls`：示例上传计划文件
- `文件2.xls`：示例实际上传情况文件

## 输出说明

### 对于基础对比分析：
生成的Excel报告包含以下列：
- 文件计划名称：文件的计划名称
- 路径：文件在系统中的路径
- 状态：匹配状态（已匹配/未匹配）

### 对于文件2着色分析：
生成的Excel文件是文件2的完整副本，但对行进行了颜色标记：

- 黄色：文件1中有上传计划，文件2中路径匹配且文件编号不为空（完全匹配）
- 橙色：文件1中有上传计划，文件2中路径匹配但文件编号为空（路径匹配但缺少文件编号）

## 技术实现

- 使用pandas处理Excel文件
- 使用openpyxl生成带颜色标记的Excel报告
- 使用tkinter创建图形用户界面（桌面版）
- 使用Flask创建Web应用（Web版）

## 注意事项

1. 工具会自动处理.xls到.xlsx的格式转换
2. 处理大文件可能需要较长时间，请耐心等待
3. Web版默认运行在9080端口